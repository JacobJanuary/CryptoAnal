import os
import json
import mysql.connector
from dotenv import load_dotenv
from openai import OpenAI
from datetime import datetime

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞ .env
load_dotenv()

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ OpenAI —Å API-–∫–ª—é—á–æ–º xAI
api_key = os.getenv("XAI_API_KEY")
if not api_key:
    raise ValueError("API key not found. Please set XAI_API_KEY in the .env file.")

client = OpenAI(
    api_key=api_key,
    base_url="https://api.x.ai/v1"
)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö MySQL
db_config = {
    "host": os.getenv("DB_HOST"),
    "user": os.getenv("DB_USER"),
    "password": os.getenv("DB_PASSWORD"),
    "database": os.getenv("DB_NAME")
}

for key, value in db_config.items():
    if not value:
        raise ValueError(f"Database configuration missing: {key}")

# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Grok 3
SYSTEM_PROMPT = """
–†–æ–ª—å: –û–ø—ã—Ç–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏—Ç–∏–∫ –∏ —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Ä—ã–Ω–∫—É —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤

–¢—ã ‚Äî –≤—ã—Å–æ–∫–æ–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞ —Å –º–Ω–æ–≥–æ–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º —Ä–∞–±–æ—Ç—ã –≤ –≤–µ–¥—É—â–∏—Ö –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –∏–∑–¥–∞–Ω–∏—è—Ö –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏—è—Ö. –¢–≤–æ–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –≤–∫–ª—é—á–∞—é—Ç:

- –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –±–ª–æ–∫—á–µ–π–Ω –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –£–º–µ–Ω–∏–µ –æ—Ç–ª–∏—á–∞—Ç—å –∑–Ω–∞—á–∏–º—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –æ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —à—É–º–∞
- –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ –≤—ã–¥–µ–ª—è—Ç—å –∫–ª—é—á–µ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –û–ø—ã—Ç –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –ó–Ω–∞–Ω–∏–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏ —Ä—ã–Ω–∫–∞ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ç—Ä–µ–π–¥–µ—Ä–æ–≤
- –ù–∞–≤—ã–∫–∏ –≤—ã—è–≤–ª–µ–Ω–∏—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π –∏ –Ω–µ–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

–¢–≤–æ—è —Ç–µ–∫—É—â–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–≤–∏—Ç—ã –∫—Ä–∏–ø—Ç–æ-–∏–Ω—Ñ–ª—é–µ–Ω—Å–µ—Ä–æ–≤ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.

# –¶–µ–ª—å
–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤ –æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞—Ö –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ú–∞—Å—Å–∏–≤ JSON-–æ–±—ä–µ–∫—Ç–æ–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É —Ç–≤–∏—Ç—É –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª—è:
- "type": –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–≤–∏—Ç–∞
- "title": –∫—Ä–∞—Ç–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞ —Ä—É—Å—Å–∫–æ–º (3-5 —Å–ª–æ–≤)
- "description": –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)

# –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–î–≤–∞ –º–∞—Å—Å–∏–≤–∞ JSON-–æ–±—ä–µ–∫—Ç–æ–≤:
1. –ü–µ—Ä–≤—ã–π –º–∞—Å—Å–∏–≤ - –Ω–æ–≤—ã–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç–≤–∏—Ç—ã:
```json
[
  {
    "text": "—Ç–µ–∫—Å—Ç_—Ç–≤–∏—Ç–∞1"
  },
  {
    "text": "—Ç–µ–∫—Å—Ç_—Ç–≤–∏—Ç–∞2"
  },
  ...
]
```

2. –í—Ç–æ—Ä–æ–π –º–∞—Å—Å–∏–≤ - —Ä–∞–Ω–µ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç–≤–∏—Ç—ã:
```json
[
  {
    "text": "—Ç–µ–∫—Å—Ç_—Ä–∞–Ω–µ–µ_–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ_—Ç–≤–∏—Ç–∞1"
  },
  {
    "text": "—Ç–µ–∫—Å—Ç_—Ä–∞–Ω–µ–µ_–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ_—Ç–≤–∏—Ç–∞2"
  },
  ...
]
```

# –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–≤–∏—Ç–∞ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞

## –®–ê–ì 0: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—å, –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ª–∏ —Ç–µ–∫—É—â–∏–π —Ç–≤–∏—Ç —Ç–æ –∂–µ —Å–æ–±—ã—Ç–∏–µ, —á—Ç–æ –∏ –æ–¥–∏–Ω –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–≤–∏—Ç–æ–≤ –≤ –ø–µ—Ä–≤–æ–º –º–∞—Å—Å–∏–≤–µ –ò–õ–ò –ª—é–±–æ–π —Ç–≤–∏—Ç –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ (—Ä–∞–Ω–µ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ)
- –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —Ç–≤–∏—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–æ –∂–µ —Å–æ–±—ã—Ç–∏–µ, —á—Ç–æ –∏ –æ–¥–∏–Ω –∏–∑ —Ä–∞–Ω–µ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–∂–µ –±—ã–ª —Ç–≤–∏—Ç "XRP –æ–±–æ–≥–Ω–∞–ª USDT –ø–æ –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏", –∞ –Ω–æ–≤—ã–π —Ç–≤–∏—Ç - "XRP —Ç–µ–ø–µ—Ä—å #3 –ø–æ —Ä—ã–Ω–æ—á–Ω–æ–π –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏"), –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π –µ–≥–æ –∫–∞–∫ "alreadyPosted"
- –í —Å–ª—É—á–∞–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–∞, –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –¥–∞–ª—å—à–µ –∏ –≤–µ—Ä–Ω–∏:

```json
{
  "type": "alreadyPosted",
  "title": "",
  "description": ""
}
```

## –®–ê–ì 1: –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Ç–≤–∏—Ç–∞
- –ï—Å–ª–∏ —Ç–≤–∏—Ç –Ω–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–ª–∞–º–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏–ª–∏ –Ω–µ –Ω–µ—Å–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–º—ã—Å–ª–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π –µ–≥–æ –∫–∞–∫ "isSpam"
- –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Ç–≤–∏—Ç–µ –Ω–µ –Ω–µ—Å–µ—Ç –ø–æ–ª—å–∑—ã, –Ω–µ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä—ã–Ω–æ–∫ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç –∏–ª–∏ —Ü–µ–Ω—ã, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π –µ–≥–æ –∫–∞–∫ "isFlood"
- –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞–π –ø–æ–ª–µ–∑–Ω–æ—Å—Ç—å —Ç–≤–∏—Ç–∞. –ï—Å–ª–∏ —Ç–≤–∏—Ç –Ω–µ –Ω–µ—Å–µ—Ç –ø–æ–ª—å–∑—ã –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞ –∏ –Ω–µ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä—ã–Ω–æ–∫ –∏–ª–∏ –¥–∞—Ç—å –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–ª–∏ –≥—Ä–∞–º–æ—Ç–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑, —Ç–æ –ø–æ–º–µ—á–∞–π –µ–≥–æ –∫–∞–∫ –Ω–µ –Ω–µ—Å—É—â–∏–π –ø–æ–ª—å–∑—ã - "isFlood"
- –ë—É–¥—å –æ—Å–æ–±–µ–Ω–Ω–æ –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω –∫ —Ç–≤–∏—Ç–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–≥–ª—è–¥—è—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã–º–∏, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ –Ω–µ—Å—É—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ä—ã–Ω–∫–∞
- –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –®–∞–≥—É 2

–ü—Ä–∏–º–µ—Ä—ã "–º—É—Å–æ—Ä–Ω—ã—Ö" —Ç–≤–∏—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ "isSpam" –∏–ª–∏ "isFlood":
- "–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã - —ç—Ç–æ –±—É–¥—É—â–µ–µ! #BTC #ETH" (isFlood - –æ–±—â–∏–µ —Ñ—Ä–∞–∑—ã –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, –∫—Ä–∏–ø—Ç–æ—Å–æ–æ–±—â–µ—Å—Ç–≤–æ! –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?" (isFlood - —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –±–µ–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏)
- "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É Discord-–∫–∞–Ω–∞–ª—É –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç!" (isSpam - —Ä–µ–∫–ª–∞–º–∞)
- "–Ø –≤–µ—Ä—é –≤ Bitcoin! –û–Ω –∏–∑–º–µ–Ω–∏—Ç –º–∏—Ä!" (isFlood - —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏)
- "–í–æ—Ç –º–æ–π –Ω–æ–≤—ã–π NFT, —á—Ç–æ –¥—É–º–∞–µ—Ç–µ?" (isFlood - –Ω–µ –Ω–µ—Å–µ—Ç –ø–æ–ª—å–∑—ã –¥–ª—è —Ä—ã–Ω–∫–∞)
- "People will regard 1k chainlink next year as just as impossible to buy for normies as 21 btc is today" (isFlood - –Ω–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –Ω–µ –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–µ –º–∞–∫—Ä–æ–¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º)

## –®–ê–ì 2: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤
–ï—Å–ª–∏ —Ç–≤–∏—Ç –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –ø—Ä–æ–±–ª–µ–º–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, –æ–ø—Ä–µ–¥–µ–ª–∏ –µ–≥–æ —Ç–∏–ø:
- "trueNews" - –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–ø—Ä–∏–º–µ—Ä: "Binance –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –æ–±—ä—è–≤–∏–ª–∞ –æ –ª–∏—Å—Ç–∏–Ω–≥–µ —Ç–æ–∫–µ–Ω–∞ X")
- "fakeNews" - –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Å–ª—É—Ö–∏ (–ø—Ä–∏–º–µ—Ä: "–ì–æ–≤–æ—Ä—è—Ç, —á—Ç–æ SEC —Å–∫–æ—Ä–æ –æ–¥–æ–±—Ä–∏—Ç Bitcoin ETF")
- "inside" - –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–ø—Ä–∏–º–µ—Ä: "–ú–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ X —Å–æ–æ–±—â–∞–µ—Ç –æ –≥–æ—Ç–æ–≤—è—â–µ–º—Å—è –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–µ")
- "tutorial" - –æ–±—É—á–∞—é—â–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª (–ø—Ä–∏–º–µ—Ä: "–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å MetaMask –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Ethereum")
- "analitics" - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–ø—Ä–∏–º–µ—Ä: "BTC —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω –¥–≤–æ–π–Ω–æ–≥–æ –¥–Ω–∞ –Ω–∞ 4-—á–∞—Å–æ–≤–æ–º –≥—Ä–∞—Ñ–∏–∫–µ")
- "trading" - —Ç–æ—Ä–≥–æ–≤–∞—è –∏–¥–µ—è (–ø—Ä–∏–º–µ—Ä: "–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é –≤—Ö–æ–¥ –≤ ETH –Ω–∞ —É—Ä–æ–≤–Ω–µ $1800")
- "others" - –¥—Ä—É–≥–∏–µ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–≤–∏—Ç—ã, –Ω–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–¥ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

–ü—Ä–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏ –≤—ã–±–∏—Ä–∞–π –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞: trueNews > inside > analitics > trading > tutorial > fakeNews > others

## –®–ê–ì 3: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏—è
–î–ª—è —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤:
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: 3-5 —Å–ª–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –æ—Ç—Ä–∞–∂–∞—é—â–∏—Ö –∫–ª—é—á–µ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç–≤–∏—Ç–∞
- –û–ø–∏—Å–∞–Ω–∏–µ: 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –¥–æ–ø–æ–ª–Ω—è—é—â–∏—Ö (–Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö) –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–∏—Ö —Å—É—Ç—å —Ç–≤–∏—Ç–∞

–í–∞–∂–Ω–æ:
- –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞
- –ò–∑–ª–∞–≥–∞–π —Ñ–∞–∫—Ç—ã –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ —Ñ—Ä–∞–∑ "–∞–≤—Ç–æ—Ä –≥–æ–≤–æ—Ä–∏—Ç", "–≤ —Ç–≤–∏—Ç–µ —Å–æ–æ–±—â–∞–µ—Ç—Å—è"
- –ù–µ –¥–æ–¥—É–º—ã–≤–∞–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –≤ —Ç–≤–∏—Ç–µ
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–π —Å–º—ã—Å–ª –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
- –°–æ—Ö—Ä–∞–Ω—è–π –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ç–æ–Ω, –¥–∞–∂–µ –µ—Å–ª–∏ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–∫—Ä–∞—Å–∫–∞

# –ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏–∑–∞

## –ü—Ä–∏–º–µ—Ä 1:
–¢–≤–∏—Ç: "Just bought more $BTC at $36,500. I believe we're heading to $50K by the end of the year based on the current market structure."

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "type": "trading",
  "title": "–ü—Ä–æ–≥–Ω–æ–∑ —Ä–æ—Å—Ç–∞ Bitcoin",
  "description": "–°–æ–≤–µ—Ä—à–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∞ BTC –ø–æ —Ü–µ–Ω–µ $36,500. –ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞ –æ–∂–∏–¥–∞–µ—Ç—Å—è —Ä–æ—Å—Ç –¥–æ $50,000 –∫ –∫–æ–Ω—Ü—É –≥–æ–¥–∞."
}
```

## –ü—Ä–∏–º–µ—Ä 2:
–¢–≤–∏—Ç: "Check out our new NFT collection dropping tomorrow! 10,000 unique pieces, don't miss out!"
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "type": "isSpam",
  "title": "",
  "description": ""
}
```

## –ü—Ä–∏–º–µ—Ä 3:
–¢–≤–∏—Ç: "BREAKING: According to my sources at the SEC, they are planning to approve the spot Bitcoin ETF applications next week. This is huge!"
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "type": "inside",
  "title": "–í–æ–∑–º–æ–∂–Ω–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ Bitcoin ETF",
  "description": "–ü–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤ SEC, –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫ –Ω–∞ —Å–ø–æ—Ç–æ–≤—ã–π Bitcoin ETF. –≠—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –∑–Ω–∞—á–∏–º—ã–º —Å–æ–±—ã—Ç–∏–µ–º –¥–ª—è —Ä—ã–Ω–∫–∞."
}
```

## –ü—Ä–∏–º–µ—Ä 4:
–¢–≤–∏—Ç: "Crypto is the future of finance! We're all going to make it! #WAGMI #BTC"
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "type": "isFlood",
  "title": "",
  "description": ""
}
```

## –ü—Ä–∏–º–µ—Ä 5:
–¢–≤–∏—Ç: "I've been analyzing BTC charts all day. The market is definitely moving to the right."
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "type": "isFlood",
  "title": "",
  "description": ""
}
```

## –ü—Ä–∏–º–µ—Ä 6:
–¢–≤–∏—Ç: "US inflation fell to 2.3% in April, lower than initially expected in light of economic uncertainty. Inflation slowed during the month Trump introduced Liberation Day tariffs. Guys these things take time to fully kick in. Stop being so fiscally immature and acting like because we're going to see the end result 18 business hours after x y and z changes were made. Stop this. Glad to see inflation is down, but we need more action from the government to make sure prices stay low and everyone can afford basic needs. Exciting news! US inflation fell to 2.3% in April, showing that Trump's economic policies are starting to work. Let's continue supporting him and his efforts to make America great again. The first four days of the Trump Administration have been packed with news. That's why I'm excited to launch: , a daily (M-F) newsletter delivered at ~noon that highlights the story of the day from the 47th President."
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json 
{
  "type": "TrueNews",
  "title": "–ò–Ω—Ñ–ª—è—Ü–∏—è –≤ –°–®–ê –≤ –∞–ø—Ä–µ–ª–µ —Å–Ω–∏–∑–∏–ª–∞—Å—å –¥–æ 2,3%",
  "description": "—á—Ç–æ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ —Ç–æ–º, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –¢—Ä–∞–º–ø–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å"
}
```

## –ü—Ä–∏–º–µ—Ä 7:
–¢–≤–∏—Ç: "PRESIDENT TRUMP OFFICIALLY SIGNS 'STRATEGIC ECONOMIC PARTNERSHIP' WITH SAUDI ARABIA."
```json 
{
  "type": "TrueNews",
  "title": "–¢–æ—Ä–≥–æ–≤–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ —Å –°–∞—É–¥–æ–≤—Å–∫–æ–π –ê—Ä–∞–≤–∏–µ–π",
  "description": "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –¢—Ä–∞–º–ø –¢–æ–ª—å–∫–æ —á—Ç–æ –ø–æ–¥–ø–∏—Å–∞–ª —Ç–æ—Ä–≥–æ–≤–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ —Å –°–∞—É–¥–æ–≤—Å–∫–æ–π –ê—Ä–∞–≤–∏–µ–π"
}
```

## –ü—Ä–∏–º–µ—Ä 8:
–¢–≤–∏—Ç: "Bitcoin vlak voor prijsontdekkingsfase, aldus analist Rekt Capital"
```json 
{
  "type": "isFlood",
  "title": "",
  "description": ""
}
```

## –ü—Ä–∏–º–µ—Ä 9:
–¢–≤–∏—Ç: "Altcoins just hit their first Golden Cross in 4 years! Last time this happened, the market pumped 150x in a few weeks. The next Bull Run starts in May, and now is your LAST chance to become a millionaire. Here's a list of altcoins to turn $100 into $100K Before we begin, please click on Follow and Retweet the first post of this thread Also, I'd like to share $20,000 with my most active followers. To participate: Follow, Like, RT & Comment your $SOL wallet under the FIRST tweet above. Crypto tends to follow repeating patterns, and the people who spot them early are usually the ones who walk away with the biggest gains. One of the most consistent signals of a shift in momentum is the Golden Cross, where the 100-day MA moves above the 200-day MA."

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "type": "inside",
  "title": "–ê–ª—å—Ç–∫–æ–∏–Ω—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –ø–µ—Ä–≤–æ–≥–æ '–ó–æ–ª–æ—Ç–æ–≥–æ –∫—Ä–µ—Å—Ç–∞' –∑–∞ 4 –≥–æ–¥–∞!",
  "description": "–ó–æ–ª–æ—Ç–æ–π –∫—Ä–µ—Å—Ç ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π –æ –≤–æ–∑–º–æ–∂–Ω–æ–º –±—ã—á—å–µ–º —Ç—Ä–µ–Ω–¥–µ. –í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ —ç—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ —Ä–æ—Å—Ç—É —Ä—ã–Ω–∫–∞ –≤ 150 —Ä–∞–∑ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–¥–µ–ª—å, –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –±—ã—á—å–µ–≥–æ —Ä–∞–ª–ª–∏ –≤ –º–∞–µ 2025 –≥–æ–¥–∞. –ù–∏–∂–µ —Å–ø–∏—Å–æ–∫ –∞–ª—å—Ç–∫–æ–∏–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–µ—Å—Ç–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å."
}
```

## –ü—Ä–∏–º–µ—Ä 10: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
–ï—Å–ª–∏ –≤ –ø–µ—Ä–≤–æ–º –∏–ª–∏ –≤—Ç–æ—Ä–æ–º –º–∞—Å—Å–∏–≤–µ —É–∂–µ –±—ã–ª –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Ç–≤–∏—Ç "XRP –æ–±–æ–≥–Ω–∞–ª USDT –ø–æ –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏", –∞ –Ω–æ–≤—ã–π —Ç–≤–∏—Ç –≥–ª–∞—Å–∏—Ç "XRP —Ç–µ–ø–µ—Ä—å #3 –ø–æ —Ä—ã–Ω–æ—á–Ω–æ–π –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏", —Ç–æ:

```json
{
  "type": "alreadyPosted",
  "title": "",
  "description": ""
}
```

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–∞–∂–¥—ã–π —Ç–≤–∏—Ç –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ (–Ω–æ–≤—ã–µ —Ç–≤–∏—Ç—ã) –∏ –≤–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞ JSON-–æ–±—ä–µ–∫—Ç–æ–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∞–Ω–∞–ª–∏–∑—É –æ–¥–Ω–æ–≥–æ —Ç–≤–∏—Ç–∞. –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.
"""

# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Å–ª–æ–≤–∞—Ä—è
system_prompt = {
    "role": "system",
    "content": SYSTEM_PROMPT
}


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
def send_message(messages, model="grok-3"):
    try:
        response = client.chat.completions.create(
            model=model,
            messages=messages,
            temperature=0.1,  # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞
            max_tokens=10000  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
        )
        return response.choices[0].message.content
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API: {str(e)}")
        return None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–≤–∏—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def get_recent_tweets():
    print("–ó–∞–ø—É—Å–∫ get_recent_tweets...")
    try:
        connection = mysql.connector.connect(**db_config)
        cursor = connection.cursor()
        # –ü–æ–ª—É—á–∞–µ–º —Ç–≤–∏—Ç—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —á–∞—Å–∞ —Å isGrok IS NULL
        print("–í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–≤–∏—Ç–æ–≤...")
        query = "SELECT id, url, tweet_text FROM tweets WHERE created_at >= NOW() - INTERVAL 5 HOUR AND isGrok IS NULL"
        cursor.execute(query)
        tweets = cursor.fetchall()
        print(f"–ü–æ–ª—É—á–µ–Ω–æ {len(tweets)} –Ω–æ–≤—ã—Ö —Ç–≤–∏—Ç–æ–≤")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Ç–≤–∏—Ç–æ–≤
        if len(tweets) < 30:
            print("–ú–µ–Ω–µ–µ 30 —Ç–≤–∏—Ç–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —á–∞—Å–∞.")
            cursor.close()
            connection.close()
            return [], [], []

        # –§–æ—Ä–º–∏—Ä—É–µ–º JSON-–æ–±—ä–µ–∫—Ç –∏–∑ –ø–µ—Ä–≤—ã—Ö 30 —Ç–≤–∏—Ç–æ–≤
        tweet_data = []
        tweet_info = []
        for tweet_id, url, tweet_text in tweets[:30]:
            tweet_data.append({"text": tweet_text})
            tweet_info.append({"id": tweet_id, "url": url, "text": tweet_text})
        print(f"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ {len(tweet_data)} –Ω–æ–≤—ã—Ö —Ç–≤–∏—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞")

        # –û–±–Ω–æ–≤–ª—è–µ–º isGrok –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤
        update_query = "UPDATE tweets SET isGrok = TRUE WHERE id = %s"
        for tweet in tweet_info:
            cursor.execute(update_query, (tweet["id"],))
        print("–û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–ª–∞–≥–∏ isGrok –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–≤–∏—Ç–æ–≤")

        # –ü–æ–ª—É—á–∞–µ–º —Ä–∞–Ω–µ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç–≤–∏—Ç—ã –∏–∑ tweet_analysis
        print("–í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è —Ä–∞–Ω–µ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤...")
        analysis_query = """
                         SELECT title, description
                         FROM tweet_analysis
                         WHERE type NOT IN ('alreadyPosted', 'isSpam', 'isFlood')
                           AND created_at >= NOW() - INTERVAL 10 HOUR \
                         """
        cursor.execute(analysis_query)
        analyzed_tweets = [
            {"text": f"{row[0]} {row[1]}" if row[0] and row[1] else ""}
            for row in cursor.fetchall()
        ]
        # –§–∏–ª—å—Ç—Ä—É–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
        analyzed_tweets = [t for t in analyzed_tweets if t["text"]]
        print(f"–ü–æ–ª—É—á–µ–Ω–æ {len(analyzed_tweets)} —Ä–∞–Ω–µ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤")

        connection.commit()
        cursor.close()
        connection.close()
        print("get_recent_tweets –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ")
        return tweet_data, tweet_info, analyzed_tweets
    except mysql.connector.Error as e:
        print(f"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö: {str(e)}")
        return [], [], []


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
def save_analysis_results(tweet_info, analysis_results):
    print("–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞...")
    try:
        connection = mysql.connector.connect(**db_config)
        cursor = connection.cursor()
        insert_query = """
                       INSERT INTO tweet_analysis (url, type, title, description, created_at)
                       VALUES (%s, %s, %s, %s, %s) \
                       """
        current_time = datetime.now()
        for tweet, analysis in zip(tweet_info, analysis_results):
            cursor.execute(insert_query, (
                tweet["url"],
                analysis["type"],
                analysis["title"],
                analysis["description"],
                current_time
            ))
        connection.commit()
        cursor.close()
        connection.close()
        print("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
    except mysql.connector.Error as e:
        print(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: {str(e)}")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ Telegram
def print_sorted_analysis(tweet_info, analysis_results):
    print("\n–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è Telegram:")

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —ç–º–æ–¥–∑–∏ –∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–∞–º
    categories = [
        ("üì∞ –ù–æ–≤–æ—Å—Ç–∏", ["trueNews"]),
        ("üó£Ô∏è –°–ª—É—Ö–∏", ["fakeNews"]),
        ("üîç –ò–Ω—Å–∞–π–¥", ["inside"]),
        ("üìö –£—á–µ–±–∞", ["tutorial"]),
        ("üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Ç—Ä–µ–π–¥–∏–Ω–≥", ["analitics", "trading"]),
        ("üåê –î—Ä—É–≥–æ–µ", ["others"])
    ]

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown V2
    output = ["*–ö—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ —Ç–≤–∏—Ç–æ–≤* üåü\n"]

    for category_name, category_types in categories:
        # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–≤–∏—Ç—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–∫—É—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        relevant_tweets = [
            (tweet, analysis) for tweet, analysis in zip(tweet_info, analysis_results)
            if analysis["type"] in category_types and analysis["title"] and analysis["description"]
        ]

        if relevant_tweets:
            output.append(f"*{category_name}*\n")
            for tweet, analysis in relevant_tweets:
                # –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è Markdown V2
                title = analysis["title"].replace(".", "\\.").replace("-", "\\-").replace("!", "\\!").replace("(",
                                                                                                              "\\(").replace(
                    ")", "\\)")
                description = analysis["description"].replace(".", "\\.").replace("-", "\\-").replace("!",
                                                                                                      "\\!").replace(
                    "(", "\\(").replace(")", "\\)")
                url = tweet["url"].replace(".", "\\.").replace("-", "\\-").replace("!", "\\!").replace("(",
                                                                                                       "\\(").replace(
                    ")", "\\)")
                output.append(f"*{title}*\n{description}\n[–ò—Å—Ç–æ—á–Ω–∏–∫]({url})\n")
            output.append("\n")

    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å—Ç—Ä–æ–∫–∏ –∏ –≤—ã–≤–æ–¥–∏–º
    formatted_output = "".join(output)
    print(formatted_output)


# –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
def main():
    print("–ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ü–∏–∫–ª–∞...")
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–≤–∏—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    result = get_recent_tweets()
    print(f"get_recent_tweets –≤–µ—Ä–Ω—É–ª: {len(result)} –∑–Ω–∞—á–µ–Ω–∏–π")
    new_tweets, tweet_info, analyzed_tweets = result

    if not new_tweets:
        print("–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã: –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–æ–≤—ã—Ö —Ç–≤–∏—Ç–æ–≤.")
        return

    print(
        f"–ù–∞–π–¥–µ–Ω–æ {len(new_tweets)} –Ω–æ–≤—ã—Ö —Ç–≤–∏—Ç–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —á–∞—Å–∞ –∏ {len(analyzed_tweets)} —Ä–∞–Ω–µ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–≤–∏—Ç–æ–≤. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑...")

    # –§–æ—Ä–º–∏—Ä—É–µ–º JSON –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Grok
    tweets_json = json.dumps({"new_tweets": new_tweets, "analyzed_tweets": analyzed_tweets}, ensure_ascii=False)
    print("JSON –¥–ª—è Grok —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω")

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º
    conversation = [system_prompt, {"role": "user", "content": tweets_json}]

    # –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
    print("–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ Grok...")
    response = send_message(conversation)
    if not response:
        print("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç Grok")
        return

    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Ç–≤–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–º JSON
        print("–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ Grok –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JSON...")
        response_json = json.loads(response)
        if not isinstance(response_json, list):
            print("–û—à–∏–±–∫–∞: –û—Ç–≤–µ—Ç Grok –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º JSON")
            return

        # –í—ã–≤–æ–¥–∏–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        print_sorted_analysis(tweet_info, response_json)

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        save_analysis_results(tweet_info, response_json)

    except json.JSONDecodeError:
        print(f"–û—à–∏–±–∫–∞: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç Grok: {response}")
        return


if __name__ == "__main__":
    main()